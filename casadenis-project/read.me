netstat -ano | findstr :3001
TCP    [::]:3001             [::]:0                 LISTENING       12345
taskkill /PID 12345 /F
http://localhost:3002/admin.html
# Casa Denis After School Website

Un sistem complet de management pentru Casa Denis After School, cu funcÈ›ionalitÄƒÈ›i avansate de administrare, mesagerie È™i galerie foto.

## ğŸŒŸ FuncÈ›ionalitÄƒÈ›i

### âœ… **Implementat Complet**
- **ğŸ“§ Sistema de Email AutomatÄƒ**
  - NotificÄƒri automate la mesaje noi
  - ConfirmÄƒri pentru vizitatori
  - Configurare flexibilÄƒ SMTP
  - Logging complet al email-urilor
 
- **ğŸ—„ï¸ Baza de Date MySQL**
  - Stocare sigurÄƒ a mesajelor
  - Statistici avansate
  - Backup automat
  - Audit trail

- **ğŸ–¼ï¸ Management Galerie**
  - Upload multiple imagini
  - Redimensionare automatÄƒ
  - Validare tipuri fiÈ™iere
  - È˜tergere Ã®n masÄƒ

- **ğŸ“Š Dashboard Admin**
  - Statistici Ã®n timp real
  - Filtrare È™i cÄƒutare avansatÄƒ
  - Management utilizatori
  - Monitorizare sistem

- **ğŸ”§ FuncÈ›ii Avansate**
  - Health check sistem
  - Backup automat
  - Rate limiting
  - Securitate enhanced

## ğŸš€ Instalare RapidÄƒ

### Pasul 1: PregÄƒtire Sistem
```bash
# CloneazÄƒ repository-ul
git clone https://github.com/your-username/casa-denis.git
cd casa-denis

# RuleazÄƒ scriptul de setup
chmod +x setup.sh
./setup.sh
```

### Pasul 2: Configurare ManualÄƒ

1. **EditeazÄƒ `.env`**:
```bash
# Database
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=your_mysql_password
DB_NAME=casa_denis_db

# Email (Gmail App Password)
SMTP_USER=casa.denis2025@gmail.com
SMTP_PASS=your_16_char_app_password
ADMIN_EMAIL=admin@casadenis.ro
```

2. **Setup MySQL Database**:
```bash
mysql -u root -p < database_setup.sql
```

3. **Start Application**:
```bash
npm start
```

## ğŸ“§ Configurare Email Gmail

### Pas cu Pas:

1. **ActiveazÄƒ 2FA pe Gmail**
   - Mergi la [Google Account Security](https://myaccount.google.com/security)
   - ActiveazÄƒ "2-Step Verification"

2. **GenereazÄƒ App Password**
   - Ãn secÈ›iunea Security â†’ App passwords
   - SelecteazÄƒ "Mail" È™i "Other"
   - Nume: "Casa Denis Website"
   - CopiazÄƒ parola de 16 caractere

3. **ActualizeazÄƒ .env**
   ```bash
   SMTP_PASS=your_16_char_app_password_here
   ```

4. **TesteazÄƒ Ã®n Admin Panel**
   - Mergi la Settings â†’ Email Settings
   - Click "Test Email Configuration"

## ğŸ—„ï¸ Schema Bazei de Date

### Tabele Principale:

```sql
-- Mesaje de la vizitatori
messages (id, name, email, phone, message, type, status, created_at)

-- ConfigurÄƒri email
email_settings (smtp_host, smtp_port, credentials, is_active)

-- Loguri email
email_logs (message_id, recipient, subject, status, sent_at)

-- Utilizatori admin
admin_users (username, email, password_hash, permissions)

-- Galerie imagini
gallery_items (filename, alt_text, file_size, upload_date)
```

## ğŸ”§ API Endpoints

### Mesaje
```bash
GET    /api/messages          # Lista mesaje cu paginare
POST   /api/messages          # Mesaj nou (din formular)
PATCH  /api/messages/:id      # ActualizeazÄƒ status
DELETE /api/messages/:id      # È˜terge mesaj
GET    /api/messages/stats    # Statistici mesaje
```

### Email
```bash
GET    /api/email-settings    # ConfigurÄƒri email
PUT    /api/email-settings    # ActualizeazÄƒ configurÄƒri
POST   /api/email-settings/test  # Test configuraÈ›ie
```

### Galerie
```bash
GET    /api/gallery           # Lista imagini
POST   /api/gallery/upload    # Upload imagine nouÄƒ
PUT    /api/gallery/:id       # EditeazÄƒ descriere
DELETE /api/gallery/:id       # È˜terge imagine
POST   /api/gallery/bulk      # OperaÈ›ii Ã®n masÄƒ
```

### Admin
```bash
POST   /api/login             # Autentificare
GET    /api/health            # Status sistem
POST   /api/backup            # CreeazÄƒ backup
```

## ğŸ“ Structura Proiect

```
casa-denis/
â”œâ”€â”€ server.js                 # Server principal
â”œâ”€â”€ .env                      # ConfigurÄƒri (nu Ã®n git)
â”œâ”€â”€ package.json              # Dependencies
â”œâ”€â”€ database_setup.sql        # Schema MySQL
â”œâ”€â”€ setup.sh                  # Script setup automat
â”œâ”€â”€ casadenis-project/
â”‚   â””â”€â”€ public/
â”‚       â”œâ”€â”€ admin.html         # Dashboard admin
â”‚       â”œâ”€â”€ index.html         # Site principal
â”‚       â”œâ”€â”€ gallery.html       # Galerie foto
â”‚       â”œâ”€â”€ nfc.html          # Link NFC
â”‚       â”œâ”€â”€ styles.css        # Stiluri
â”‚       â””â”€â”€ images/           # Upload imagini
â”œâ”€â”€ data/                     # JSON files (backup)
â”‚   â”œâ”€â”€ hero.json
â”‚   â”œâ”€â”€ about.json
â”‚   â”œâ”€â”€ programs.json
â”‚   â”œâ”€â”€ schedule.json
â”‚   â”œâ”€â”€ spaces.json
â”‚   â”œâ”€â”€ gallery.json
â”‚   â”œâ”€â”€ testimonials.json
â”‚   â”œâ”€â”€ contact.json
â”‚   â””â”€â”€ messages.json
â”œâ”€â”€ backups/                  # Backup-uri automate
â””â”€â”€ logs/                     # Log files
```

## ğŸ‘¨â€ğŸ’¼ Utilizare Admin Panel

### Acces: `http://localhost:3001/admin.html`
**Login**: `admin` / `parola123`

### FuncÈ›ionalitÄƒÈ›i:

1. **ğŸ“Š Dashboard**
   - Statistici mesaje noi
   - Activitate recentÄƒ
   - Status sistem

2. **ğŸ“§ Mesaje**
   - Filtrare dupÄƒ tip/status
   - CÄƒutare Ã®n conÈ›inut
   - RÄƒspuns direct la email
   - Export Ã®n Excel

3. **ğŸ–¼ï¸ Galerie**
   - Upload drag & drop
   - Editare descrieri
   - È˜tergere multiplÄƒ
   - Preview imagini

4. **âš™ï¸ ConfigurÄƒri**
   - Email SMTP settings
   - Backup manual
   - User management
   - System health

## ğŸ”’ Securitate

### MÄƒsuri Implementate:
- **Rate Limiting**: 100 requests/15min per IP
- **Input Validation**: Sanitizare toate input-urile
- **SQL Injection Protection**: Prepared statements
- **File Upload Security**: Validare tipuri È™i mÄƒrime
- **Password Hashing**: bcrypt cu 10 rounds
- **CORS Protection**: Configurare specificÄƒ
- **Error Handling**: Nu expune informaÈ›ii sensibile

### RecomandÄƒri ProducÈ›ie:
```bash
# 1. SchimbÄƒ parolele default
# 2. ConfigureazÄƒ firewall
# 3. SSL certificate
# 4. Backup regulat
# 5. Monitoring logs
# 6. Update dependencies
```

## ğŸ“ˆ Monitorizare & Backup

### Health Check:
```bash
curl http://localhost:3001/api/health
```

### Backup Manual:
```bash
curl -X POST http://localhost:3001/api/backup
```

### Logs Location:
```bash
# Application logs
tail -f logs/application.log

# Email logs (in database)
SELECT * FROM email_logs ORDER BY sent_at DESC LIMIT 100;

# Error logs
tail -f logs/error.log
```

## ğŸ› ï¸ Dezvoltare

### Development Mode:
```bash
npm run dev  # cu nodemon
```

### Database Migrations:
```bash
# Run new migration
mysql -u root -p casa_denis_db < migrations/001_add_new_feature.sql
```

### Testing Email:
```bash
# Test cu curl
curl -X POST http://localhost:3001/api/email-settings/test \
  -H "Content-Type: application/json" \
  -d '{"test_email": "your-email@example.com"}'
```

## ğŸš¨ Troubleshooting

### Probleme Comune:

1. **Email nu se trimite**
   ```bash
   # VerificÄƒ logs
   SELECT * FROM email_logs WHERE status = 'failed' ORDER BY sent_at DESC;
   
   # VerificÄƒ configuraÈ›ie
   curl http://localhost:3001/api/email-settings
   ```

2. **Eroare MySQL**
   ```bash
   # VerificÄƒ conexiune
   mysql -u root -p -e "SELECT 1"
   
   # VerificÄƒ baza de date
   mysql -u root -p -e "USE casa_denis_db; SHOW TABLES;"
   ```

3. **Upload imagini eÈ™ueazÄƒ**
   ```bash
   # VerificÄƒ permissions
   chmod 755 casadenis-project/public/images
   
   # VerificÄƒ spaÈ›iu disk
   df -h
   ```

4. **Port ocupat**
   ```bash
   # GÄƒseÈ™te procesul care foloseÈ™te portul
   lsof -i :3001
   
   # Sau schimbÄƒ portul Ã®n .env
   PORT=3002
   ```

## ğŸ“ Support

Pentru probleme sau Ã®ntrebÄƒri:
- **Email**: casa.denis2025@gmail.com
- **Telefon**: +40 740 490 171
- **GitHub Issues**: [Create Issue](https://github.com/your-username/casa-denis/issues)

## ğŸ“„ LicenÈ›Äƒ

Acest proiect este proprietatea Casa Denis After School.
Toate drepturile rezervate Â© 2024.

---

**ğŸ  Casa Denis - Un loc unde copiii Ã®nfloresc! ğŸŒŸ**